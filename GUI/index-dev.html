<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>TickTalk GUI</title>
    <link rel="stylesheet" type="text/css" href="index-dev.css" media="screen" />
  </head>
  <body>
    <div class="slidecontainer">
      <p id="exampleDemo"> </p>
      <input type="range" min="1" max="100" value="25" class="slider" id="stepRange">      
    </div>

    <div class="filecontainer">
      <p>Please select a timeseries file</p>
      <input type="file" name="file" id="file" />
    </div>
    
    <div class="canvascontainer">
      <canvas style="display: block" id="canvas" width="255" height="255"/>
    </div>

    <!-- Include Scala.js compiled code -->
    <script type="text/javascript" src="target/scala-2.12/ticktalk-gui-fastopt.js">
    </script>

    <script>
      const DELAY = 100;

      const gui = new Grid2DVisualization(3, 2, 20, new Map([[1, "black"]]), document.getElementById("canvas"));
      
      gui.main();

      function prepare_step(texts) {
        const iter = texts[Symbol.iterator]();
        let result; 

        function innerStep() {
          if (!(result = iter.next()).done) {
            gui.visualizeInput(result.value.split(',').map(Number));
          }
        }

        setInterval(innerStep, DELAY);
      }

      document.getElementById('file').onchange = function(){
        var file = this.files[0];
        var reader = new FileReader();
        reader.onload = function(progressEvent){    
            console.log("Simulation file loaded!")
            prepare_step(this.result.split(/\r\n|\n/));
        };
        reader.readAsText(file);
      };
    </script>
  </body>
</html>


